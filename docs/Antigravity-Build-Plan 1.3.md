# Alpha Vantage Explorer Build Plan v1.3 - Granular API Extension

**Version:** 1.3
**Target Release:** v0.2.0
**Created:** 2026-01-11
**Purpose:** Extend the tool to support granular, per-endpoint CLI commands while maintaining backward compatibility with bulk mode.

---

## User Review Required

> [!IMPORTANT]
> **Breaking Changes**: None. This is a backward-compatible extension.
>
> **New Mode**: Granular command mode co-exists with bulk mode.
> - Bulk mode: `alphavantage_cli --live-api --symbols AAPL,NVDA`
> - Granular mode: `alphavantage_cli overview --symbol AAPL --live-api`

> [!WARNING]
> **CSV Output Handling**: Some endpoints return CSV (e.g., `LISTING_STATUS`). The granular mode will:
> 1. Save raw CSV to file (no transformation)
> 2. Display "CSV saved to `<path>`" message
> 3. **NOT** convert CSV to markdown tables automatically

---

## Architecture Decisions

### CLI Command Structure
```bash
# Pattern: <tool> <endpoint-command> --symbol <TICKER> [options]
alphavantage_cli overview --symbol AAPL --live-api
alphavantage_cli income-statement --symbol NVDA --output ./reports
alphavantage_cli earnings-calendar --symbol MSFT --quarter 2024-Q1
```

### Output Strategy
- **JSON responses**: Save both raw JSON and markdown table
- **CSV responses**: Save raw CSV only, no transformation
- **Markdown tables**: Full dataset (all rows), not truncated
- **File naming**: `<endpoint>_<symbol>_<timestamp>.<ext>`

### Backward Compatibility
- Existing bulk mode (`--symbols` flag) remains unchanged
- New granular commands use `--symbol` (singular) flag
- Shared infrastructure (rate limiter, client, parsers)

---

## Phase 9: CLI Subcommand Architecture

### 9.1 Antigravity Instructions

```
@Antigravity

PHASE 9: CLI Subcommand Foundation

CONTEXT:
Extend the CLI to support granular subcommands for each of the 13 company-specific endpoints.
The current CLI uses a monolithic approach with `--symbols` for bulk mode. We need to add
subcommands while preserving the existing functionality.

TASKS:

9.1 Update CLI argument parsing (crates/cli/src/main.rs):
   - Migrate from flat Args struct to clap subcommands
   - Create `Commands` enum with two variants:
     - `Bulk { symbols, out_dir, live_api }` (existing mode)
     - `Granular { subcommand: EndpointCommand }`
   - Create `EndpointCommand` enum with 13 variants:
     - Overview { symbol, output, live_api }
     - IncomeStatement { symbol, output, live_api }
     - BalanceSheet { symbol, output, live_api }
     - CashFlow { symbol, output, live_api }
     - Earnings { symbol, output, live_api }
     - EarningsEstimates { symbol, output, live_api }
     - NewsSentiment { symbol, output, live_api, limit }
     - InsiderTransactions { symbol, output, live_api }
     - Dividends { symbol, output, live_api }
     - Splits { symbol, output, live_api }
     - SharesOutstanding { symbol, output, live_api }
     - EarningsCalendar { symbol, output, live_api, horizon }
     - EarningsCallTranscript { symbol, output, live_api, year, quarter }

9.2 Parameter validation (crates/core/src/domain/endpoint.rs):
   - Add validation methods for optional parameters:
     - `validate_quarter(q: &str) -> Result<(), ValidationError>`
     - `validate_year(y: u16) -> Result<(), ValidationError>`
     - `validate_horizon(h: &str) -> Result<(), ValidationError>`
   - Ensure ticker symbol validation is reused from existing `Ticker` type

9.3 Add endpoint parameter types (crates/core/src/domain/params.rs - NEW FILE):
   - Create `QuarterParam` enum: Q1, Q2, Q3, Q4
   - Create `HorizonParam` enum: ThreeMonth, SixMonth, TwelveMonth
   - Implement FromStr for CLI parsing
   - Implement Display for query string generation

9.4 Update config loading (crates/cli/src/config.rs):
   - Modify `Config::from_args` to handle both command modes
   - Extract common config (api_key, rate_limit, client_mode)
   - Keep singular vs plural symbol distinction clear

9.5 Create granular executor (crates/cli/src/granular_executor.rs - NEW FILE):
   - Implement `GranularExecutor` struct
   - Method: `execute_single_endpoint(cmd: EndpointCommand, config: Config) -> Result<()>`
   - Handle JSON vs CSV output branching
   - Generate timestamped filenames
   - Print user-friendly success messages

VERIFICATION:
1. Run `cargo build` â†’ compiles without errors
2. Run `alphavantage_cli --help` â†’ shows both bulk and granular subcommands
3. Run `alphavantage_cli overview --help` â†’ shows symbol, output, live-api flags
4. Run `cargo test --package alphavantage_cli` â†’ all tests pass
5. Test backward compatibility: `cargo run -- --symbols AAPL` â†’ works as before

OUTPUT:
Report:
- âœ… Subcommand structure implemented
- âœ… 13 endpoint commands defined
- âœ… Parameter validation added
- âœ… Help documentation auto-generated by clap
- âœ… Backward compatibility verified
```

---

## Phase 10: Full Output Retention & Markdown Generation

### 10.1 Antigravity Instructions

```
@Antigravity

PHASE 10: Full Output Retention & Enhanced Markdown

CONTEXT:
The current markdown writer truncates output to top 3 rows. For granular mode,
users want FULL output retention. We need to modify the markdown writer to support
both truncated (bulk mode) and full (granular mode) output.

TASKS:

10.1 Extend MarkdownWriter (crates/client/src/markdown_writer.rs):
   - Add `truncate_rows: bool` field to `MarkdownWriter`
   - Modify `write_table` method:
     - If `truncate_rows == true`: limit to 3 rows (existing behavior)
     - If `truncate_rows == false`: write ALL rows
   - Add method `with_truncation(truncate: bool) -> Self` for builder pattern

10.2 Update JSON-to-table conversion (crates/core/src/logic/json_to_table.rs):
   - Add `max_rows: Option<usize>` parameter to `parse_to_tables` function
   - If `max_rows == None`: include all rows
   - If `max_rows == Some(n)`: limit to n rows
   - Ensure column headers are extracted from ALL rows (union of keys), not just first row

10.3 Enhance table metadata (crates/core/src/logic/json_to_table.rs):
   - Add `total_rows: usize` and `displayed_rows: usize` to `Table` struct
   - Append note at end of table: "(Showing N of M total rows)" if truncated
   - For full mode: "(Showing all M rows)"

10.4 CSV passthrough handler (crates/client/src/csv_handler.rs - NEW FILE):
   - Create `CsvHandler` struct
   - Method: `save_raw(content: &str, path: &Path) -> Result<()>`
   - Method: `detect_csv(headers: &HeaderMap) -> bool` (check Content-Type)
   - NO conversion logic - just save as-is

10.5 Update JSONPersister (crates/client/src/json_persister.rs):
   - Add `save_csv` method alongside existing `save_json`
   - Handle CSV files in `out/raw/` directory structure
   - Add file extension detection (.json vs .csv)

VERIFICATION:
1. Run unit test: `cargo test json_to_table::test_full_output_retention`
2. Create a mock endpoint with 100 rows â†’ verify all 100 rows in markdown
3. Test CSV endpoint (LISTING_STATUS) â†’ verify raw CSV is saved, no markdown table
4. Check metadata notes â†’ "(Showing 3 of 50 total rows)" appears correctly
5. Run `cargo clippy` â†’ no warnings

OUTPUT:
Report:
- âœ… Full output mode implemented
- âœ… CSV passthrough working
- âœ… Table metadata enhanced
- âœ… Tests passing for both truncated and full modes
```

---

## Phase 11: Granular Execution Logic

### 11.1 Antigravity Instructions

```
@Antigravity

PHASE 11: Granular Execution Pipeline

CONTEXT:
Wire up the granular executor to the client layer. Each granular command should:
1. Validate parameters
2. Make a single API call (respecting rate limits)
3. Save raw output (JSON or CSV)
4. Generate markdown (if JSON)
5. Print success message with file paths

TASKS:

11.1 Implement endpoint routing (crates/cli/src/granular_executor.rs):
   - Method: `route_command(cmd: &EndpointCommand) -> (Endpoint, QueryParams)`
   - Map each `EndpointCommand` variant to core `Endpoint` enum
   - Extract query parameters from command struct
   - Example:
     ```rust
     EndpointCommand::IncomeStatement { symbol, .. } => {
         (Endpoint::IncomeStatement, hashmap!{"symbol" => symbol})
     }
     ```

11.2 Add single-fetch method (crates/client/src/http_client.rs):
   - Method: `fetch_single(endpoint: Endpoint, params: QueryParams) -> Result<Response>`
   - Reuse existing `execute_request` infrastructure
   - Return both raw bytes and content-type header
   - This is the singular version of bulk `fetch_ticker_endpoint`

11.3 Implement output workflow (crates/cli/src/granular_executor.rs):
   - Create output directory if not exists
   - Generate filename: `{endpoint}_{symbol}_{timestamp}.{ext}`
   - Branch on content-type:
     - If JSON:
       a. Save raw JSON to `out/raw/{filename}.json`
       b. Parse JSON â†’ tables
       c. Generate markdown to `out/{filename}.md`
       d. Print: "âœ“ Saved: {md_path} and {json_path}"
     - If CSV:
       a. Save raw CSV to `out/raw/{filename}.csv`
       b. Print: "âœ“ Saved: {csv_path} (CSV format, no markdown conversion)"

11.4 Error handling for granular mode (crates/cli/src/granular_executor.rs):
   - Catch rate limit errors â†’ print user-friendly message with reset time
   - Catch network errors â†’ print retry suggestion
   - Catch parse errors â†’ save raw anyway, print error message
   - Exit with non-zero code on failure (single endpoint call)

11.5 Add timestamp utilities (crates/core/src/util/timestamp.rs - NEW FILE):
   - Function: `generate_timestamp() -> String` (ISO 8601 format: YYYYMMDD_HHMMSS)
   - Function: `format_duration(seconds: u64) -> String` ("5m 30s" format)
   - Use for filenames and rate limit wait messages

VERIFICATION:
1. Test granular call (mock mode): `cargo run -- overview --symbol AAPL`
   â†’ Check files exist: `out/overview_AAPL_{timestamp}.md` and `out/raw/overview_AAPL_{timestamp}.json`
2. Test CSV endpoint: `cargo run -- earnings-calendar --symbol MARKET`
   â†’ Check CSV file exists, no markdown generated
3. Test rate limit: trigger rate limit â†’ verify message shows reset time
4. Run all unit tests: `cargo test --package alphavantage_cli granular_executor`
5. Test invalid symbol: `cargo run -- overview --symbol INVALID123` â†’ friendly error

OUTPUT:
Report:
- âœ… Endpoint routing complete
- âœ… Single-fetch method working
- âœ… JSON and CSV workflows functional
- âœ… Timestamped output files generated
- âœ… Error messages user-friendly
```

---

## Phase 12: Unified Help & Manual Documentation

### 12.1 Antigravity Instructions

```
@Antigravity

PHASE 12: Documentation Consolidation

CONTEXT:
Create comprehensive, unified documentation covering:
1. Bulk mode (existing functionality)
2. Granular mode (new functionality)
3. Manual pages for each endpoint command
4. Output format specifications

TASKS:

12.1 Update README.md:
   - Add "Usage Modes" section with two subsections:
     - "Bulk Mode": existing `--symbols` workflow
     - "Granular Mode": new subcommand workflow
   - Add "Endpoint Reference" table:
     | Command | Description | Required Params | Optional Params | Output Format |
   - Include examples for both modes
   - Add "Output Formats" section explaining JSON vs CSV

12.2 Create docs/manual/commands.md (NEW FILE):
   - Document all 13 endpoint commands
   - For each command:
     - Syntax: `alphavantage_cli <command> --symbol <TICKER> [OPTIONS]`
     - Description: what the endpoint does
     - Required parameters table
     - Optional parameters table
     - Output format: JSON/CSV, column headers if JSON
     - Example usage with mock mode and live mode
   - Add CSV endpoint note: "Returns CSV format, no markdown conversion"

12.3 Create docs/manual/output-formats.md (NEW FILE):
   - Section: JSON Output Structure
     - Raw JSON location: `out/raw/{filename}.json`
     - Markdown location: `out/{filename}.md`
     - Table formatting rules (column headers, all rows)
   - Section: CSV Output Structure
     - Raw CSV location: `out/raw/{filename}.csv`
     - No transformation applied
     - Opening instructions (recommend: `cat`, `csvlook`, Excel)
   - Section: Output Examples (with screenshots if needed)

12.4 Generate man pages (docs/man/ - NEW DIRECTORY):
   - Use `clap_mangen` crate to auto-generate man pages from CLI definitions
   - Add `build.rs` script to generate during build
   - Install location: `/usr/local/share/man/man1/alphavantage_cli.1`
   - Commands:
     - `man alphavantage_cli` â†’ main help
     - `man alphavantage_cli-overview` â†’ endpoint help

12.5 Update CHANGELOG.md:
   - Add `[0.2.0]` section with date
   - List new features:
     - Granular per-endpoint commands
     - Full output retention
     - CSV passthrough
     - Enhanced documentation
   - Note backward compatibility maintained

12.6 Add inline help (crates/cli/src/help.rs - NEW FILE):
   - Function: `print_endpoint_help(cmd: &str)` â†’ rich help for each command
   - Use `clap`'s built-in `--help` generation
   - Enhance with examples and notes about output formats

VERIFICATION:
1. Read `README.md` â†’ both modes clearly documented
2. Read `docs/manual/commands.md` â†’ all 13 endpoints documented
3. Run `alphavantage_cli --help` â†’ lists subcommands
4. Run `alphavantage_cli overview --help` â†’ shows parameters and output format
5. Build man pages: `cargo build` â†’ check `target/man/` directory
6. Review CHANGELOG.md â†’ v0.2.0 entry complete

OUTPUT:
Report:
- âœ… README.md updated with dual-mode documentation
- âœ… Manual pages created for all endpoints
- âœ… Output format guide complete
- âœ… Man pages auto-generated
- âœ… CHANGELOG.md updated
```

---

## Phase 13: Testing & Quality Assurance

### 13.1 Antigravity Instructions

```
@Antigravity

PHASE 13: Comprehensive Testing

CONTEXT:
Ensure the new granular mode is thoroughly tested without breaking existing bulk mode.
All tests must pass, clippy must be clean, and fmt must be verified.

TASKS:

13.1 Unit tests for granular executor (crates/cli/tests/granular_tests.rs - NEW FILE):
   - Test: `test_endpoint_routing()` â†’ verify all 13 commands route correctly
   - Test: `test_parameter_validation()` â†’ invalid quarter/year/horizon rejected
   - Test: `test_filename_generation()` â†’ timestamps and naming correct
   - Test: `test_output_path_creation()` â†’ directories created as needed
   - Use mock file system (tempdir) for output testing

13.2 Integration tests for granular mode (crates/cli/tests/cli_granular_integration.rs - NEW FILE):
   - Test: `test_granular_json_workflow()` â†’ mock JSON endpoint â†’ verify MD + raw JSON
   -Test: `test_granular_csv_workflow()` â†’ mock CSV endpoint â†’ verify raw CSV only
   - Test: `test_granular_rate_limit()` â†’ trigger rate limit â†’ verify error message
   - Test: `test_full_output_retention()` â†’ endpoint with 50 rows â†’ verify all 50 in markdown
   - Use mock HTTP server (existing fixtures)

13.3 Backward compatibility tests (crates/cli/tests/bulk_mode_regression.rs - NEW FILE):
   - Test: `test_bulk_mode_unchanged()` â†’ run existing `--symbols AAPL` â†’ verify output matches v0.1.0
   - Test: `test_bulk_truncation()` â†’ verify bulk mode still truncates to 3 rows
   - Compare output snapshots using `insta` crate

13.4 CSV handler tests (crates/client/tests/csv_handler_tests.rs - NEW FILE):
   - Test: `test_csv_detection()` â†’ verify Content-Type header parsing
   - Test: `test_csv_save()` â†’ verify CSV written correctly
   - Test: `test_csv_no_conversion()` â†’ ensure no markdown generation for CSV

13.5 Parameter validation tests (crates/core/tests/param_validation_tests.rs - NEW FILE):
   - Test: `test_valid_quarters()` â†’ Q1, Q2, Q3, Q4 accepted
   - Test: `test_invalid_quarters()` â†’ Q5, INVALID rejected
   - Test: `test_year_bounds()` â†’ 1900-2100 accepted, others rejected
   - Test: `test_horizon_values()` â†’ valid horizons accepted

13.6 Run quality gates:
   - `cargo fmt --all -- --check` â†’ MUST pass (fix any issues immediately)
   - `cargo clippy --all-targets --all-features -- -D warnings` â†’ MUST pass
   - `cargo test --workspace` â†’ all tests pass
   - `cargo build --release` â†’ builds successfully

VERIFICATION:
1. Run `cargo test --workspace` â†’ all tests pass (print test count)
2. Run `cargo clippy` â†’ zero warnings
3. Run `cargo fmt --check` â†’ no formatting issues
4. Run bulk mode test: `cargo run -- --symbols AAPL` â†’ output matches v0.1.0
5. Run granular test: `cargo run -- overview --symbol AAPL` â†’ files created correctly

OUTPUT:
Report:
- âœ… 25+ new tests added (granular + regression)
- âœ… All tests passing (N/N)
- âœ… Clippy clean (0 warnings)
- âœ… Formatting verified
- âœ… Backward compatibility confirmed
```

---

## Phase 14: CI/CD & Release Preparation

### 14.1 Antigravity Instructions

```
@Antigravity

PHASE 14: Release Engineering

CONTEXT:
Prepare for v0.2.0 release with enhanced CI/CD to prevent fmt/clippy issues.
Update GitHub Actions, create release artifacts, and tag the release.

TASKS:

14.1 Enhance GitHub Actions (.github/workflows/ci.yml):
   - Add explicit `cargo fmt -- --check` step BEFORE clippy
   - Add `cargo clippy -- -D warnings` step
   - Add `cargo test --workspace --all-features` step
   - Add `cargo build --release` step
   - Ensure all steps use `--all-features` and `--all-targets`
   - Set workflow to fail fast on first error

14.2 Add pre-push git hook (.githooks/pre-push - NEW FILE):
   - Script content:
     ```bash
     #!/bin/bash
     cargo fmt -- --check || exit 1
     cargo clippy --all-targets -- -D warnings || exit 1
     cargo test --workspace || exit 1
     ```
   - Prevents pushing code that will fail CI
   - Document in README.md how to install: `git config core.hooksPath .githooks`

14.3 Update version numbers:
   - `Cargo.toml` (workspace root): version = "0.2.0"
   - `crates/cli/Cargo.toml`: version = "0.2.0"
   - `crates/client/Cargo.toml`: version = "0.2.0"
   - `crates/core/Cargo.toml`: version = "0.2.0"
   - Ensure inter-crate dependencies use `version = "0.2.0"`

14.4 Create release checklist (docs/RELEASE_CHECKLIST.md - NEW FILE):
   - Pre-release verification:
     - [ ] All tests pass locally
     - [ ] Clippy clean
     - [ ] Fmt verified
     - [ ] Documentation updated (README, CHANGELOG, manual)
     - [ ] Version numbers bumped
   - Release steps:
     - [ ] Create git tag: `git tag v0.2.0`
     - [ ] Push tag: `git push origin v0.2.0`
     - [ ] Create GitHub Release with notes from CHANGELOG
     - [ ] Build binaries: `cargo build --release`
     - [ ] Attach binaries to GitHub Release

14.5 Generate release notes (RELEASE_NOTES.md - NEW FILE):
   - Summary of v0.2.0 features
   - Migration guide (bulk vs granular mode)
   - Breaking changes: NONE
   - Known issues / limitations
   - Copy relevant sections to GitHub Release description

VERIFICATION:
1. Run CI locally: `.github/workflows/ci.yml` â†’ all steps pass
2. Test pre-push hook: attempt push without fmt â†’ blocked
3. Verify version consistency: `grep -r 'version = "0.2.0"' Cargo.toml`
4. Build release binary: `cargo build --release` â†’ check `target/release/alphavantage_cli`
5. Run release binary: `target/release/alphavantage_cli --version` â†’ shows "0.2.0"

OUTPUT:
Report:
- âœ… GitHub Actions enhanced with fmt/clippy gates
- âœ… Pre-push hook preventing CI failures
- âœ… Version numbers updated to 0.2.0
- âœ… Release checklist created
- âœ… Ready for v0.2.0 tag
```

---

## Phase 15: Live API Validation

### 15.1 Antigravity Instructions

```
@Antigravity

PHASE 15: Production Validation

CONTEXT:
Final validation using live API to ensure granular mode works correctly with real endpoints.
This step must be done carefully to avoid consuming many API credits.

TASKS:

15.1 Test single JSON endpoint (OVERVIEW):
   - Run: `cargo run --release -- overview --symbol AAPL --live-api --output ./validation`
   - Verify:
     - Raw JSON saved to `validation/raw/overview_AAPL_{timestamp}.json`
     - Markdown saved to `validation/overview_AAPL_{timestamp}.md`
     - Markdown contains ALL rows (not truncated)
     - Rate limiter respected (1-second delay enforced)
   - Check file sizes: JSON > 5KB, Markdown > 8KB (approx)

15.2 Test CSV endpoint (EARNINGS_CALENDAR):
   - Run: `cargo run --release -- earnings-calendar --symbol AAPL --live-api --output ./validation`
   - Verify:
     - Raw CSV saved to `validation/raw/earnings_calendar_AAPL_{timestamp}.csv`
     - NO markdown file generated
     - Console output: "âœ“ Saved CSV to {path}"
   - Open CSV file â†’ verify it's valid CSV format

15.3 Test endpoint with optional parameters (NEWS_SENTIMENT):
   - Run: `cargo run --release -- news-sentiment --symbol AAPL --limit 50 --live-api`
   - Verify:
     - Limit parameter passed correctly in query string
     - Output contains up to 50 news items
     - Check raw JSON URL query params

15.4 Test Earnings Call Transcript (EARNINGS_CALL_TRANSCRIPT):
   - Run: `cargo run --release -- earnings-call-transcript --symbol AAPL --year 2023 --quarter Q4 --live-api --output ./validation`
   - Verify:
     - Raw JSON saved to `validation/raw/earnings_call_transcript_AAPL_{timestamp}.json`
     - Markdown saved to `validation/earnings_call_transcript_AAPL_{timestamp}.md`
     - Contains transcript content

15.5 Test Financial Statement (INCOME_STATEMENT):
   - Run: `cargo run --release -- income-statement --symbol AAPL --live-api --output ./validation`
   - Verify:
     - Raw JSON saved to `validation/raw/income_statement_AAPL_{timestamp}.json`
     - Markdown saved to `validation/income_statement_AAPL_{timestamp}.md`
     - Contains full financial data (all rows)

15.6 Test rate limit handling:
   - Run multiple granular commands in quick succession
   - Verify:
     - Delay enforced between calls
     - Daily limit counter increments
     - Token state persisted correctly
   - Check log output for rate limit messages

VERIFICATION:
1. Review all generated files in `./validation` directory
2. Check raw JSON/CSV files are complete and valid
3. Check markdown files have proper formatting
4. Verify rate limiter logs show delays and token counts
5. Confirm NO errors or panics during live runs

OUTPUT:
Report:
- âœ… JSON endpoint validated (OVERVIEW)
- âœ… CSV endpoint validated (EARNINGS_CALENDAR)
- âœ… Optional parameters working (NEWS_SENTIMENT)
- âœ… Earnings Transcript validated
- âœ… Income Statement validated
- âœ… Rate limiting functioning correctly
- ðŸŽ‰ v0.2.0 ready for release
```

---

## Git Workflow (All Phases)

### Branch Strategy
```bash
# For Phase 9
git checkout main
git checkout -b phase-9-subcommands

# After Antigravity completes Phase 9
git add -A
git commit -m "Phase 9: Implement CLI subcommand architecture"
git push origin phase-9-subcommands
# Create PR â†’ Review â†’ Merge â†’ Delete branch

# Repeat for Phases 10-15
```

### Rollback Strategy
If a phase causes issues:
```bash
# Option 1: Revert last commit
git revert HEAD
git push origin <branch-name>

# Option 2: Reset to previous commit
git reset --hard HEAD~1
git push origin <branch-name> --force

# Option 3: Create hotfix branch from last known good commit
git checkout -b hotfix/<issue> <good-commit-sha>
```

### Tag Management
```bash
# After all phases complete and validation passes
git checkout main
git tag -a v0.2.0 -m "Release v0.2.0: Granular API commands"
git push origin v0.2.0

# If rollback needed
git tag -d v0.2.0
git push origin :refs/tags/v0.2.0
```

---

## Additional Considerations

### Performance
- **Concern**: Full output for large datasets (e.g., LISTING_STATUS CSV can be 10MB+)
- **Solution**: Add `--max-rows <N>` optional flag to granular commands for user control
- **Default**: No limit (full output as requested)

### UX Enhancements
- **Progress indication**: For endpoints that may take >5s, print "Fetching..." message
- **Color output**: Use terminal colors for success (green âœ“) and errors (red âœ—)
- **Smart defaults**: If `--output` not specified, use `./out` (consistent with bulk mode)

### Error Scenarios
- **Invalid endpoint parameters**: Return helpful message, e.g., "Quarter must be Q1, Q2, Q3, or Q4"
- **Network timeout**: Print retry suggestion: "Network timeout. Retry with: <same command>"
- **Rate limit hit**: Display reset time: "Rate limit reached. Resets at 2026-01-11 00:00 UTC"

### Documentation Gaps
- **FAQ section**: Common questions about bulk vs granular mode
- **Troubleshooting**: Network issues, rate limits, invalid responses
- **Examples gallery**: Real-world use cases for each command

### Future-Proofing
- **API versioning**: Prepare for Alpha Vantage API schema changes (already handled by dynamic JSON parsing)
- **Plugin system**: Placeholder for custom output formatters (e.g., Excel export)
- **Bulk-granular hybrid**: E.g., "fetch earnings for these 5 symbols" (not in v0.2.0, but plan for v0.3.0)

---

## Success Criteria

Phase complete when:
1. âœ… All unit tests pass (`cargo test --workspace`)
2. âœ… Clippy clean with `-D warnings`
3. âœ… `cargo fmt --check` passes
4. âœ… Live API validation successful (all 3 test cases)
5. âœ… Backward compatibility verified (spot-check v0.1.0 output)
6. âœ… Documentation complete and reviewed
7. âœ… GitHub Actions CI passing
8. âœ… Pre-push hook installed and working

Release ready when:
1. âœ… All 15 phases complete
2. âœ… Version bumped to 0.2.0
3. âœ… CHANGELOG.md updated
4. âœ… Git tag `v0.2.0` created
5. âœ… GitHub Release published with binaries
